---
layout: post
title: "양자컴퓨팅으로 PS하는법"
date: 2023-12-25
author: red1108
tags: [quantum, quantum-computing, ps, problem-ssolving]
---

> 제목을 조금 자극적이게 "양자컴퓨팅으로 PS하는 법"이라고 설명했지만, 아직 일반적인 PS를 하는 데 양자컴퓨터를 사용하는것은 어렵다. 그래도 그나마 PS스러운 max cut 문제를 양자컴퓨터로 해결하는 방법을 최대한 쉽게 소개하고자 한다. 나중에도 양자컴퓨터를 사용한 소개할만한 알고리즘이 있다면 소개해볼 계획이다.

# Max cut 문제란?

Max cut 문제는 주어진 그래프를 두 집합으로 잘 분리하여 두 집합 사이를 연결하는 간선의 수를 최대화하는 문제이다.

<p align="center"><img src="/assets/images/red1108/maxcut-introduce.png"></p>
<center><b>그림 1. Maxcut 예시.</b>흰색과 검은색 정점 집합으로 위와 같이 분리하면 둘 사이를 연결하는 간선(빨간색)이 5개로 최대가 된다. 따라서 이 그래프에서 maxcut 은 5이다.</center>

이 문제를 다항 시간에 해결할 수 있을 지 없을 지 잠시 고민해 보자. 아마 방법이 떠오르지 않을 것이다.

그리고 만약 누군가가 주어진 복잡한 그래프의 max cut이 10204531이라고 주장했다고 해 보자. 그래도 친절하게 어떻게 정점 집합을 분리해야 저 답이 나오는지는 제공했다고 치자. 그럼 저 그래프의 max cut이 실제로 10204531인지를 다항 시간에 검증할 수 있을까? 정점 집합을 제공받았으니 직접 카운팅 해서 해당 경우에 cut이 10204531이라는 건 확인할 수 있을 것이다. 그러나 저거보다 더 큰 값이 불가능하다는 것을 검증하기는 굉장히 힘들 것만 같다...

위 두 가지 문제를 통해 직감적으로 느꼈듯, 일반적인 그래프에 대해 max cut을 다항 시간에 구할 수도 없고, 다항 시간에 답을 검증할 수도 없다. 따라서 이 문제는 NP-hard 문제이다. 증명은 이 글의 목적에는 맞지 않으므로 넘어가자.

## Max cut의 근사 알고리즘

정확한 답은 절대로 다항 시간에 구할 수가 없기 때문에, 주된 연구 방향은 근사 알고리즘이다. 예를 들어, 주어진 그래프의 max cut이 M이고 어떤 알고리즘으로 구한 답이 A일 때, $A/M > 0.7$ 을 보장할 수 있다면 이 알고리즘은 0.7-approximation algorithm이라고 한다. 0.879-approximation 알고리즘은 다항 시간에 구할 수 있다는 것이 알려져 있다[1]. 하지만 이번 글의 목적은 양자 알고리즘을 소개하는 것이다. 하지만 **양자 알고리즘으로도 max cut문제를 다항 시간에 해결할 수 없다.** 양자 알고리즘으로도 아직까지는 approximation 알고리즘이 한계이며, 이 알고리즘을 소개해보고자 한다.

# Max cut을 양자 알고리즘으로 해결하기

양자 알고리즘의 접근법은 다음과 같다: (TODO: 내용 추가하자.)

## 1. 양자 상태로 표현하기

Max cut 문제의 본질은 그래프의 정점을 두 부분집합으로 분할하는 것이다. 

<p align="center"><img src="/assets/images/red1108/maxcut_graph.png" width="300px"></p>
<center><b>그림 2. 앞으로 예시로 들 그래프.</b></center>

위 그래프는 정점을 4개 가지고 있다. 그리고 누가 보아도 maxcut은 4이다. 0, 2번 정점과 1, 3번 정점을 서로 다른 집합으로 나누면 된다.

이제 문제를 해결하기 위해 큐비트 4개를 준비할 것이다. 그래프의 정점이 n개라면 n개의 큐비트를 준비하면 된다.

그리고 $0 \leq i \lt n$인 정수 i에 대해 i번째 큐비트는 i번째 정점이 어느 집합에 속하는지에 대한 정보를 저장할 것이다. 집합은 두 개 뿐이므로 $|0\rangle$, $|1\rangle$로 나누자. 같은 값을 가진다면 같은 집합에 속하는 것이다.

그렇다면, 이 문제의 답이 되는 양자 상태는 $|0101\rangle, |1010\rangle$일 것이다. 이제 우리는 저 양자 상태만 확률을 최대화하여 남겨 놓고, 나머지 상태들은 확률을 없애버리는 것이 목표이다. 이후엔 관측을 통해 양자 정답 상태를 구할 수 있고, 이로부터 max cut을 구할 수 있다. 그렇다면 어떻게 저 상태들만 남기고 나머지 상태들을 지울 수 있을까? Hamiltonian을 사용하면 된다.


## 2. 헤밀토니안 정의하기

양자 컴퓨팅에서 Hamiltonian이란 양자 상태를 넣으면 그 상태의 에너지가 나오는 Observable이다. 물론 관측값일 뿐이므로, 명칭이 '에너지'라고 해서 실제로 양자 상태의 에너지를 의미하지는 않는다. 우리가 정의하기 나름이다.

이런 류의 문제 상황에서 전형적인 문제해결의 방법은 다음과 같다.

1. 문제 상황에 대응되는 Hamiltonian을 만드는데, 바닥상태가 문제의 정답이어야 한다.
2. 여러 가지 방법을 써서 바닥상태(정답)를 찾는다.

위 기준에 따르면 우리의 목표는 $|0101\rangle, |1010\rangle$가 바닥상태가 되는 Hamiltonian을 설계하는 것이다. 일반화한다면, cut의 개수가 많아질수록 에너지가 낮아지는 Hamiltonian을 설계 하면 바닥 상태가 항상 문제의 정답이 될 것이다.

### 2.1 Motivation

정점 i가 속한 집합을 $c_i$ 라고 표기하자. 그리고 어느 집합에 속하는지에 따라서 $c_i = $ 1 또는 -1 값을 배정하자. maxcut에 해당하는 경우는 $c_0, c_1, c_2, c_3 = -1, 1, -1, 1$ 또는 $c_0, c_1, c_2, c_3 = 1, -1, 1, -1$ 이다.

그리고 그래프의 연결 상태를 표현한 인접행렬 $a_{ij}$는 정점 i와 정점 j가 간선으로 바로 연결되어 있으면 1, 아니면 0이라고 하자. 그렇다면 주어진 집합 배정 $\{c_i\}$에 의해 결정되는 cut의 개수는 다음과 같은 식으로 계산할 수 있다.

$$C = \frac{1}{2}\sum_{i \leq j}{a_{ij}(1-c_ic_j)}$$

쉬운 식이지만 조금만 첨언하자면, 정점 i, j가 같은 집합이라면 $c_i c_j=1$이므로 더해지는 값이 0이고, 둘 사이의 간선도 존재하면서 $c_i c_j = -1$일 때 2가 더해진다. 그래서 $\frac{1}{2}$ 을 곱해서 맞춰주는 것이다.

### 2.2 Hamiltonian설계

위 식을 그대로 적용한 Hamiltonian을 만들어 보자. 양자 상태가 $|0\rangle$ 일때는 1, $|1\rangle$일때는 -1이 되는 걸 떠올려 보면 Z operator가 떠오른다. $Z|0\rangle = 1, Z|1\rangle = -1$ 이기 때문이다. (또는 $\sigma_z$ 로 표기하기도 함)

이제 Hamiltonian을 설계해 보자

$$H = \frac{1}{2}\sum_{i \leq j}{a_{ij}(1-Z_i Z_j)}$$

이면 된다. 이 Hamiltonian이 바로 양자 상태를 cut의 개수로 매핑시켜 주는 Observable이다. 그런데 우리는 이를 에너지로 해석하고, 바닥 상태를 구하고 싶다. 따라서 부호를 음수로 만들어주면 된다.

$$H = -\frac{1}{2}\sum_{i \leq j}{a_{ij}(1-Z_i Z_j)}$$

이제 이 Hamiltonian의 바닥 상태를 구하면 문제의 답을 구하는 것이다.

## 참고문헌

[1] Goemans, Michel X., and David P. Williamson. ". 879-approximation algorithms for max cut and max 2sat." Proceedings of the twenty-sixth annual ACM symposium on Theory of computing. 1994.