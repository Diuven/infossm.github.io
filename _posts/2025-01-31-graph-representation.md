---
layout: post

title: "다양한 그래프 표현 방법"

date: 2025-01-31

author: jinhan814

tags: [algorithm, graph-theory]
---

## 개요

그래프는 다양한 방법으로 표현될 수 있습니다. 각 방법은 특정 상황에서 장단점을 가지며, 문제의 요구 사항에 따라 적절한 표현 방법을 선택하는 것이 중요합니다.

이 글에서는 그래프를 표현하는 4가지 방법인 인접 행렬(Adjacency Matrix), 인접 리스트(Adjacency List), CSR(Compressed Sparse Row), 그리고 XOR Linked Tree에 대해 설명합니다.

(XOR Linked Tree 개념은 코드포스 글 [https://codeforces.com/blog/entry/135239](https://codeforces.com/blog/entry/135239)을 참고해 작성했습니다)

## 1. 인접 행렬 (Adjacency Matrix)

### 개념
인접 행렬은 그래프를 2차원 배열로 표현하는 방법입니다. 그래프에 `i`번 정점에서 `j`번 정점으로 가는 간선이 있다면 `i`행 `j`열의 원소 `g[i][j]`를 $1$로, 그렇지 않으면 $0$으로 표시합니다. 가중치 그래프의 경우는 `g[i][j]`에 가중치를 저장할 수도 있습니다.

인접 행렬은 `i`번 정점에서 `j`번 정점로 가는 간선이 존재하는지 여부를 $\mathcal{O}(1)$에 구할 수 있다는 장점이 있으며, 공간 복잡도가 $\mathcal{O}(V^2)$이고 인접한 정점을 순회하는 시간 복잡도가 $\mathcal{O}(V)$라는 단점이 있습니다.

이러한 성질에 의해 인접 행렬은 주로 $E \simeq V^2$인 밀집 그래프(dense graph)가 주어지는 상황에 자주 사용됩니다.

## 2. 인접 리스트 (Adjacency List)

### 개념
인접 리스트는 그래프를 각 정점마다 연결된 정점들의 리스트를 저장하며 표현하는 방법입니다. 인접 리스트는 `i`번 정점에 대해 `i`번 정점에서 `j`번 정점으로 가는 간선이 있는 정점 `j`들을 `adj[i]`에 저장합니다. 가중치 그래프의 경우는 간선의 가중치 `c`를 `j`와 함께 pair로 `adj[i]`에 저장할 수 있습니다.

인접 리스트를 이용하면 $\mathcal{O}(V + E)$의 공간 복잡도에 그래프를 저장할 수 있으며 인접한 정점을 순회하는 시간 복잡도가 실제로 인접한 정점의 개수인 $\mathcal{O}(deg(i))$와 같다는 장점이 있습니다. 단점은 `i`번 정점에서 `j`번 정점으로 가는 간선이 존재하는지 여부를 확인하는 시간복잡도가 $\mathcal{O}(deg(i))$로 인접 행렬에 비해 비효율적입니다.

인접 리스트는 $E \ll V^2$인 희소 그래프(sparse graph)에서 효율적이며, 정점과 간선의 개수가 모두 $10^5$ scale인 그래프 문제에서 자주 사용됩니다.

## 3. CSR(Compressed Sparse Row) 표현

### 개념
인접 리스트를 이용한 그래프 표현법은 $V$가 $10^5$ scale로 커도 그래프를 $\mathcal{O}(V + E)$의 공간 복잡도로 저장할 수 있습니다. 하지만 `std::vector`와 같은 동적 배열을 이용하면 array doubling에 의한 성능 저하가 있고, cache hit rate가 떨어진다는 한계점이 있습니다.

인접 행렬을 CSR(Compressed Sparse Row) 표현을 이용해 저장하면 인접 리스트의 단점을 보완할 수 있습니다. $E \ll V^2$인 경우 인접 행렬의 대부분의 원소는 $0$입니다. 이 사실을 이용하면 $V^2$의 메모리를 이용해 명시적으로 인접 행렬을 저장하는 대신 `g[u][v]`가 $0$이 아닌 $(u, v)$에 대한 정보만 저장하며 메모리 사용량을 줄일 수 있습니다.

CSR 표현은 길이가 $E$인 배열 `csr[0], ..., csr[E - 1]`과 길이가 $V + 1$인 배열 `cnt[0], ..., cnt[V]`로 이루어집니다.

- `csr` 배열은 `g[u][v]`가 $0$이 아닌 $(u, v)$ pair를 오름차순 정렬한 뒤 $v$를 나열한 배열입니다.
- `cnt` 배열은 $u$에서 나가는 간선의 개수를 `out[u]`라 할 때 `out` 배열에 대한 prefix sum 배열입니다.