---
layout: post
title:  "기하 문제를 스스로 해결하는 AI"
date:   2024-01-29
author: garam1732
tags: [mathematics]
---

> 2024년 1월 17일, **Solving olympiad geometry without human demonstrations**이라는 논문이 Nature에 실렸습니다. 논문에 따르면, AlphaGeomtery라는 AI가 IMO(국제 수학 올림피아드)에 출제된 기하 문제 30개 중 무려 25개를 스스로 해결하였으며, 이는 IMO 금메달리스트의 성적 평균에 준하는 수준이라 합니다. 

해당 글에서는 논문의 내용을 간단히 정리한 후, AI의 실제 풀이를 구체적으로 살펴보며 AI의 성능을 분석해보려 합니다.

## Background

AI 연구에서 관심받던 주제 중 하나로, 스스로 증명을 구축하는 AI의 개발은 이전부터 다양한 연구가 진행되어 왔습니다. 해당 연구의 가장 큰 장벽은, 사람의 수학적 증명을 기계 친화적인 언어로 변화하는 것이 어렵다는 것입니다. 특히나 기하학의 경우 기본적인 증명 예시가 적으며, 다양한 기하학적 도구들을 표현하는 것이 어렵다고 합니다. 

해당 논문에서 오직 **순수 기하**, 즉 평면에서 다루는 유클리드 기하학 문제만을 다룹니다. 간혹 기하 부등식(길이나 각에 대한 부등식)이나 조합 기하 문제(PS에서 다루는 기하 유형)가 출제되는 경우도 있는데, 해당 연구에서 이런 문제는 배제되었습니다. 그 외에도 기계 친화적 언어로 변환이 힘든 몇몇 문제가 배제되었습니다. 

일반적으로 AI가 평면 기하를 해결하는 방법은 두 가지가 있습니다.

#### 1. Computer Algebra Method
주어진 점들을 좌표로, 직선이나 원을 방정식으로 표현한 후 연립을 통해 결론과 동일한 식이 도출되는지 검증하는 방식입니다. 가장 근원적인 증명 방법으로 볼 수 있습니다. 기본적으로 명제가 참인 이상, 전제식으로부터 결론식이 무조건 도출될 수 밖에 없기 때문에, **이론적으로** 무적 풀이법이기도 합니다. 그러나 이 방법은 그림이 조금만 복잡해지더라도 식이 기하급수적으로 복잡해집니다. 인간은 물론, AI 조차도 계산하기 어려운 수준이라 합니다.

#### 2. Search(Synthetic) Method
실질적으로 인간이 사용하는 증명 방식입니다. 참인 여러 개의 전제들로부터 여러 단계의 연역 추론을 거쳐 결론을 논리적으로 도출해내는 방식입니다. 대다수의 AI, 그리고 AlphaGeometry가 해당 방식을 사용합니다. 이때 이 추론 방식은 크게 두 가지 유형으로 나뉩니다. 먼저 기본적이라고 여겨지는 조건 명제들을 이용합니다. 전이 관계(Transitivity)를 이용한 자명한 추론부터, 일직선이나 공원점 등을 도출해내는 기본 추론을 사용합니다. 그러나 이러한 추론만으로는 도출해낼 수 없는 명제들도 있습니다. 

가장 간단한 예시를 생각해봅시다. "이등변삼각형에서 두 밑각의 크기는 같다"라는 명제를 증명해봅시다.   
중학교에서 배우는 간단한 명제입니다. 그러나 막상 시도해보면, 추론 규칙만으로는 증명이 어려울 것입니다. 이 문제를 증명하는 데에는 **보조점**이 필요합니다. 밑변의 중점이라는 새로운 점을 정의하면, 만들어지는 두 직각삼각형의 합동으로부터 결론을 도출해낼 수 있습니다. 

아무리 추론 규칙을 적용해봤자 주어진 그림을 벗어나지는 못하기 때문에, 때로는 새로운 점을 잡아 새로운 관찰을 하는 시도가 필요합니다. 실제로 대부분의 IMO 기하 문제들은 적어도 1개 이상의 보조점을 의도하는 경우가 많습니다. 문제에서 요구하는 보조점을 얼마나 잘 찾느냐에 따라 기하 실력이 나뉜다는 말도 있습니다. 그런데 이 보조점을 찾는 것이, 생각보다 어려운 작업입니다. 유한한 그림에서는 유한 개의 추론만 가능한 것에 비해, 보조점을 잡는 방법은 정말 무수히 많습니다. 특히나 AI의 입장에서 보조점을 찾는 작업은 무한한 가지를 뻗어나가는 것이라 볼 수 있습니다. 그렇기에 기하 문제를 푸는 AI에게 있어 가장 도전적인 과제가 바로 "적절한 보조점을 찾는 방법"입니다.

## Method

이제 본격적으로 AlphaGeometry에 적용된 여러가지 방법들에 대해 알아보겠습니다.

#### Training Mechanism

AlphaGeometry의 훈련 메커니즘을 간단히 정리하면 다음과 같습니다. 기본 전제들로 구성된 테이블에서 일부를 골라 consistent한 전제 집합 P를 생성합니다. 그 후 주어진 P의 전제들을 바탕으로 증명 알고리즘을 적용해 결론 N을 도출합니다. 마지막으로, 증명 과정에서 만들어진 DAG를 거슬러 올라가며 P에서 N이 도출된 경로 G(N)을 찾습니다. 이렇게 구성된 (P, N, G(N))이 하나의 훈련 데이터가 됩니다. 

- Auxiliary Point Training

훈련 데이터를 구성하기 위해서는 두 가지 알고리즘이 필요합니다. 첫째, 전제들을 바탕으로 결론을 도출하는 알고리즘입니다. 해당 논문에서는 DD와 AR이라는 방법을 이용합니다. 둘째, 연역 경로 G(N)을 **최소화하는** 알고리즘이 필요합니다. 불필요한 연역 과정 및 전제는 풀이가 불필요하게 길어지게 만드므로, 이에 대한 최적화 알고리즘도 필요합니다.

#### Proving Mechanism

AlphaGeometry의 동작은 두 가지 단계로 구분됩니다. 먼저 Symbolic Deduction Engine이 주어진 그림에서 연역 추론을 반복해 Deduction Closure에 도달합니다. 그래도 결론이 도출되지 않았을 때, Language Model이 적합한 보조점을 선택합니다. 두 작업이 번갈아 이루어지며, 결론을 도출하거나 최대 탐색 횟수에 도달할 때까지 반복합니다. 

Symbolic Deduction Engine은 말 그대로 논리적 추론을 담당하는 DD(Deduction Database)와 대수적 계산을 담당하는 AR(Algebra Relation)로 나뉩니다. 구체적으로 DD는 definite Horn clause의 형태에 대한 추론 규칙에 따릅니다. AlphaGeometry는 그래프 자료 구조를 사용하여 등식이나 공점선, 공원점을 찾아낸다고 합니다. 반면 AR은 대수적인 분석을 담당하며, 각이나 길이 비율 등을 계산합니다. 주어진 각이나 길이 조건은 일반적으로 선형 일차 방정식의 형태로 표현이 가능합니다. <예시> 이때 여러 개의 선형 일차식으로부터 도출되는 결론들은 가우스 소거법을 적용하여 쉽게 알아낼 수 있습니다.

#### Optimization

최소 연역 알고리즘

## Analysis